steps:
  - command: "build/run 2.3.3 'rake metrics:coverage'"
    label: ":rspec: RSpec"
    agents:
      - queue=elastic

  - name: ':rspec: Corpus tests (rubyspec)'
    command: build/run 2.3.3 'rspec --tag corpus:rubyspec'
    agents:
      - queue=elastic

  - name: ':rspec: Corpus tests (regexp_parser)'
    command: build/run 2.3.3 'rspec --tag corpus:regexp_parser'
    agents:
      - queue=elastic

  - name: ':rspec: Corpus tests (axiom)'
    command: build/run 2.3.3 'rspec --tag corpus:axiom'
    agents:
      - queue=elastic

  - name: ':rspec: Integration tests'
    command: build/run 2.3.3 'rspec --exclude-pattern "**/corpus_spec.rb" --format documentation spec/integration'
    agents:
      - queue=elastic

  - name: ':skull: Mutest'
    command: build/run 2.3.3 'rake metrics:mutant'
    timeout_in_minutes: 10
    agents:
      - queue=elastic

  - name: ':rubocop: Rubocop'
    command: build/run 2.3.3 'rake metrics:rubocop'
    agents:
      - queue=elastic

  - name: ':japanese_ogre: Flay'
    command: build/run 2.3.3 'rake metrics:flay'
    agents:
      - queue=elastic

  - name: ':imp: Flog'
    command: build/run 2.3.3 'rake metrics:flog'
    agents:
      - queue=elastic

  - name: ':hankey: Reek'
    command: build/run 2.3.3 'rake metrics:reek'
    agents:
      - queue=elastic
